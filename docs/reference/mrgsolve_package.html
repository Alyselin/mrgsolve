<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>mrgsolve — mrgsolve • mrgsolve</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">mrgsolve</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/metrumresearchgroup/mrgsolve">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>mrgsolve</h1>
    </div>

    
    <p>mrgsolve is an R package maintained under the auspices of Metrum Research Group, LLC, that facilitates
simulation from models based on systems of ordinary differential equations (ODE) that are typically employed
for understanding pharmacokinetics, pharmacodynamics, and systems biology and pharmacology.
mrgsovle consists of computer code written in the R and C++ languages, providing an interface to
the DLSODA differential equation solver (written in FORTRAN) provided through ODEPACK -
A Systematized Collection of ODE Solvers.</p>
    

        
    <h2 class="hasAnchor" id="example-models"><a class="anchor" href="#example-models"></a>Example models</h2>

    <p></p>
    <p>See <code><a href='mrgsolve_example.html'>mrgsolve_example</a></code> to export example models into your own, writeable project directory.</p>
    
    <h2 class="hasAnchor" id="input-data-sets"><a class="anchor" href="#input-data-sets"></a>Input data sets</h2>

    <p></p>
    <p>See <code><a href='data_set.html'>data_set</a></code> for help creating input data sets.  See <code><a href='exdatasets.html'>exdatasets</a></code> for example input data sets.</p>
    
    <h2 class="hasAnchor" id="package-help"><a class="anchor" href="#package-help"></a>Package help</h2>

    <p></p>
    <p><ul>
<li>  Package <a href = 'index'>00Index.html</a>, including a listing of all functions
 </li>
<li> Reserved words in <code>mrgsolve</code>: <code><a href='reserved.html'>reserved</a></code>
</li>
</ul></p>
    
    <h2 class="hasAnchor" id="about-the-model-object"><a class="anchor" href="#about-the-model-object"></a>About the model object</h2>

    <p></p>
    <p>The model object has class <code><a href='mrgmod-class.html'>mrgmod</a></code>.</p>
    
    <h2 class="hasAnchor" id="handling-simulated-output"><a class="anchor" href="#handling-simulated-output"></a>Handling simulated output</h2>

    <p></p>
    <p>See <code><a href='mrgsims.html'>mrgsims</a></code> for methods to use with simulated output.</p>
    
    <h2 class="hasAnchor" id="about-the-solver-used-by-code-mrgsolve-code-"><a class="anchor" href="#about-the-solver-used-by-code-mrgsolve-code-"></a>About the solver used by &lt;code&gt;mrgsolve&lt;/code&gt;</h2>

    <p></p>
    <p>See: <code><a href='aboutsolver.html'>aboutsolver</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples">
<span class='co'>## example("mrgsolve")</span>

<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='kw'>mrgsolve</span><span class='kw'>:::</span><span class='fu'><a href='house.html'>house</a></span>(<span class='kw'>delta</span><span class='kw'>=</span><span class='fl'>0.1</span>)  <span class='kw'>%&gt;%</span> <span class='fu'><a href='$,mrgmod-method.html'>param</a></span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='fl'>0.5</span>)

<span class='no'>events</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='events.html'>ev</a></span>(<span class='kw'>amt</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>cmt</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>addl</span><span class='kw'>=</span><span class='fl'>5</span>, <span class='kw'>ii</span><span class='kw'>=</span><span class='fl'>24</span>)

<span class='no'>events</span>

<span class='no'>mod</span>

<span class='fu'><a href='see.html'>see</a></span>(<span class='no'>mod</span>)
?
<span class='fu'><a href='stime.html'>stime</a></span>(<span class='no'>mod</span>)

<span class='fu'><a href='$,mrgmod-method.html'>param</a></span>(<span class='no'>mod</span>)
<span class='fu'><a href='init.html'>init</a></span>(<span class='no'>mod</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='no'>events</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='mrgsim.html'>mrgsim</a></span>(<span class='kw'>end</span><span class='kw'>=</span><span class='fl'>168</span>)

<span class='no'>out</span>
<span class='fu'>head</span>(<span class='no'>out</span>)
<span class='fu'>tail</span>(<span class='no'>out</span>)
<span class='fu'>dim</span>(<span class='no'>out</span>)

<span class='kw'>mrgsolve</span><span class='kw'>:::</span><span class='fu'><a href='mod.html'>mod</a></span>(<span class='no'>out</span>)
<span class='fu'><a href='$,mrgmod-method.html'>param</a></span>(<span class='no'>out</span>)

<span class='fu'>plot</span>(<span class='no'>out</span>, <span class='no'>GUT</span>+<span class='no'>CP</span>~<span class='no'>.</span>)

<span class='no'>sims</span> <span class='kw'>&lt;-</span> <span class='fu'>as.data.frame</span>(<span class='no'>out</span>)

<span class='no'>t72</span> <span class='kw'>&lt;-</span> <span class='fu'>subset</span>(<span class='no'>sims</span>, <span class='no'>time</span><span class='kw'>==</span><span class='fl'>72</span>)
<span class='fu'>str</span>(<span class='no'>t72</span>)



<span class='no'>idata</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>ID</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>), <span class='kw'>CL</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>),<span class='kw'>VC</span><span class='kw'>=</span><span class='fl'>12</span>)
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='no'>events</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='mrgsim.html'>mrgsim</a></span>(<span class='kw'>end</span><span class='kw'>=</span><span class='fl'>168</span>, <span class='kw'>idata</span><span class='kw'>=</span><span class='no'>idata</span>, <span class='kw'>req</span><span class='kw'>=</span><span class='st'>""</span>)
<span class='fu'>plot</span>(<span class='no'>out</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='no'>events</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='mrgsim.html'>mrgsim</a></span>(<span class='kw'>carry.out</span><span class='kw'>=</span><span class='st'>"amt,evid,cmt,CL"</span>)
<span class='fu'>head</span>(<span class='no'>out</span>)


<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='events.html'>ev</a></span>() <span class='kw'>%&gt;%</span> <span class='fu'><a href='knobs.html'>knobs</a></span>(<span class='kw'>CL</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>0.5</span>, <span class='fl'>1</span>,<span class='fl'>2</span>), <span class='kw'>amt</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>100</span>,<span class='fl'>300</span>,<span class='fl'>1000</span>), <span class='kw'>cmt</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>end</span><span class='kw'>=</span><span class='fl'>48</span>)
<span class='fu'>plot</span>(<span class='no'>out</span>, <span class='no'>CP</span>~<span class='no'>.</span>, <span class='kw'>scales</span><span class='kw'>=</span><span class='st'>"same"</span>)
<span class='fu'>plot</span>(<span class='no'>out</span>, <span class='no'>RESP</span>+<span class='no'>CP</span>~<span class='no'>time</span><span class='kw'>|</span><span class='no'>amt</span>,<span class='kw'>groups</span><span class='kw'>=</span><span class='no'>CL</span>)


<span class='no'>ev1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='kw'>amt</span><span class='kw'>=</span><span class='fl'>500</span>, <span class='kw'>cmt</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>rate</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='no'>ev2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='kw'>amt</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>cmt</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>time</span><span class='kw'>=</span><span class='fl'>54</span>, <span class='kw'>ii</span><span class='kw'>=</span><span class='fl'>8</span>, <span class='kw'>addl</span><span class='kw'>=</span><span class='fl'>10</span>)
<span class='no'>events</span> <span class='kw'>&lt;-</span> <span class='no'>ev1</span>+<span class='no'>ev2</span>
<span class='no'>events</span>

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='no'>ev1</span>+<span class='no'>ev2</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='mrgsim.html'>mrgsim</a></span>(<span class='kw'>end</span><span class='kw'>=</span><span class='fl'>180</span>, <span class='kw'>req</span><span class='kw'>=</span><span class='st'>""</span>)
<span class='fu'>plot</span>(<span class='no'>out</span>)




<span class='co'>## Full NMTRAN data set</span>
<span class='fu'>data</span>(<span class='no'>exTheoph</span>)
<span class='fu'>head</span>(<span class='no'>exTheoph</span>)

<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='kw'>mrgsolve</span><span class='kw'>:::</span><span class='fu'><a href='house.html'>house</a></span>(<span class='kw'>delta</span><span class='kw'>=</span><span class='fl'>0.1</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='data_set.html'>data_set</a></span>(<span class='no'>exTheoph</span>) <span class='kw'>%&gt;%</span> <span class='no'>mrgsim</span>

<span class='fu'>plot</span>(<span class='no'>out</span>,<span class='no'>CP</span>~<span class='no'>time</span><span class='kw'>|</span><span class='fu'>factor</span>(<span class='no'>ID</span>),<span class='kw'>type</span><span class='kw'>=</span><span class='st'>'b'</span>, <span class='kw'>scales</span><span class='kw'>=</span><span class='st'>"same"</span>)


<span class='co'>## "Condensed" data set</span>
<span class='fu'>data</span>(<span class='no'>extran1</span>)
<span class='no'>extran1</span>

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='data_set.html'>data_set</a></span>(<span class='no'>extran1</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='mrgsim.html'>mrgsim</a></span>(<span class='kw'>end</span><span class='kw'>=</span><span class='fl'>200</span>)

<span class='fu'>plot</span>(<span class='no'>out</span>,<span class='no'>CP</span>~<span class='no'>time</span><span class='kw'>|</span><span class='fu'>factor</span>(<span class='no'>ID</span>))


<span class='co'>## idata</span>
<span class='fu'>data</span>(<span class='no'>exidata</span>)
<span class='no'>exidata</span>

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='kw'>amt</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>cmt</span><span class='kw'>=</span><span class='fl'>1</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='idata_set.html'>idata_set</a></span>(<span class='no'>exidata</span>) <span class='kw'>%&gt;%</span>  <span class='fu'><a href='mrgsim.html'>mrgsim</a></span>(<span class='kw'>end</span><span class='kw'>=</span><span class='fl'>72</span>)

<span class='fu'>plot</span>(<span class='no'>out</span>, <span class='no'>CP</span>~<span class='no'>.</span>, <span class='kw'>as</span><span class='kw'>=</span><span class='st'>"log10"</span>)



<span class='no'>code</span> <span class='kw'>&lt;-</span> <span class='st'>'
$PARAM CL=1, VC=10, KA=1.1
$INIT GUT=0, CENT=0
$SET end=48, delta=0.25

$MAIN
double CLi = CL*exp(ETA(1));
double VCi = VC*exp(ETA(2));
double ke = CLi/VCi;

$OMEGA @correlation
0.04 0.6 0.09

$ODE
dxdt_GUT = -KA*GUT;
dxdt_CENT = KA*GUT - ke*CENT;

$TABLE
double CP = CENT/VCi;

$CAPTURE CP
'</span>

<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mcode_cache.html'>mcode</a></span>(<span class='st'>"package_example"</span>,<span class='no'>code</span>) <span class='kw'>%&gt;%</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='kw'>amt</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>cmt</span><span class='kw'>=</span><span class='fl'>1</span>, <span class='kw'>addl</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>ii</span><span class='kw'>=</span><span class='fl'>8</span>)

<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='no'>mrgsim</span>

<span class='no'>out</span>

<span class='fu'>plot</span>(<span class='no'>out</span>)


<span class='co'># Internal model library</span>

<span class='no'>mod</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='mread_cache.html'>mread</a></span>(<span class='st'>"irm1"</span>, <span class='fu'><a href='modlib.html'>modlib</a></span>())

<span class='no'>mod</span>

<span class='no'>mod</span> <span class='kw'>%&gt;%</span> <span class='fu'><a href='events.html'>ev</a></span>(<span class='kw'>amt</span><span class='kw'>=</span><span class='fl'>300</span>, <span class='kw'>ii</span><span class='kw'>=</span><span class='fl'>12</span>, <span class='kw'>addl</span><span class='kw'>=</span><span class='fl'>3</span>) <span class='kw'>%&gt;%</span> <span class='no'>mrgsim</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      
      <li><a href="#example-models">Example models</a></li>

      <li><a href="#input-data-sets">Input data sets</a></li>

      <li><a href="#package-help">Package help</a></li>

      <li><a href="#about-the-model-object">About the model object</a></li>

      <li><a href="#handling-simulated-output">Handling simulated output</a></li>

      <li><a href="#about-the-solver-used-by-code-mrgsolve-code-">About the solver used by &lt;code&gt;mrgsolve&lt;/code&gt;</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kyle T Baron.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
